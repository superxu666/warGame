var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);n.prototype=t.prototype,e.prototype=new n},main;!function(e){var t=function(t){function n(){var n=t.call(this)||this,a=n;return a.back=SkinManager.createImage(a,0,0,"war_left_bg_png",URLConf.gameImg+"w2sheet.png"),a.personalView=e.PersonalView.getInstance(),a.addElement(a.personalView),a.chatView=e.ChatView.getInstance(),a.chatView.x=20,a.chatView.y=150,a.addElement(a.chatView),n}return __extends(n,t),n.getInstance=function(){return n._instance||(n._instance=new n)},n.prototype.renderPersonvalView=function(e){var t=this;t.personalView.render(e)},n.prototype.notifyChatView=function(e){var t=this;t.chatView.createWebsocket(e)},n}(GYLite.GYUIComponent);e.SideTopLeftView=t,__reflect(t.prototype,"main.SideTopLeftView")}(main||(main={}));var main;!function(e){var t=function(t){function a(){var e=t.call(this)||this,a=e;a.vb=new VerticalBox(n),a.vb.width=210,a.vb.height=380,a.vb.scroller.verticalPolicy=0,a.vb.scrollerViewPort.paddingTop=a.vb.scrollerViewPort.paddingBottom=5,a.addElement(a.vb);var i=SkinManager.createImage(a,-12,a.vb.y+a.vb.height+10,"war_chat_line_png",URLConf.gameImg+"w3sheet.png");return a.input=TemplateTool.createTextInput(a,0,i.y+i.height+2,160,30),a.send=SkinManager.createBtn(a,a.input.x+a.input.width+14,a.input.y,"war_send_msg_img_png",null,null,URLConf.gameImg+"w1sheet.png"),a.bindEvent(),a.arr=[{msg:"牛逼",nickName:"小王",grade:"2",type:"1",userId:"1"},{msg:"牛逼",nickName:"小王",grade:"1",type:"1",userId:"1"},{msg:"牛逼",nickName:"小王",grade:"3",type:"1",userId:"1"},{msg:"牛逼",nickName:"小王",grade:"5",type:"1",userId:"1"},{msg:"牛逼",nickName:"小王",grade:"4",type:"1",userId:"1"},{msg:"牛逼",nickName:"阿萨德",grade:"2",type:"1",userId:"1"},{msg:"牛逼",nickName:"小王",grade:"1",type:"1",userId:"1"},{msg:"阿斯顿发文而阿斯顿发文而阿斯顿发文而阿斯顿发文而阿斯顿发文而",nickName:"小王",grade:"2",type:"1",userId:"1"},{msg:"牛逼",nickName:"小王",grade:"4",type:"1",userId:"1"},{msg:"牛逼",nickName:"小王",grade:"2",type:"1",userId:"1"},{msg:"暗示法阿的说法",nickName:"小王",grade:"2",type:"1",userId:"1"},{msg:"暗示法阿的说法",nickName:"阿萨德",grade:"3",type:"1",userId:"1"},{msg:"暗示法阿的说法",nickName:"小王",grade:"4",type:"1",userId:"1"},{msg:"暗示法阿的说法",nickName:"小王",grade:"2",type:"1",userId:"1"},{msg:"暗示法阿的说法",nickName:"小王",grade:"6",type:"1",userId:"1"},{msg:"暗示法阿的说法",nickName:"阿萨德",grade:"2",type:"1",userId:"1"},{msg:"暗示法阿的说法",nickName:"小王",grade:"7",type:"1",userId:"1"},{msg:"暗示法阿的说法",nickName:"小王",grade:"5",type:"1",userId:"1"},{msg:"暗示法阿的说法",nickName:"阿萨德",grade:"2",type:"1",userId:"1"}],e}return __extends(a,t),a.getInstance=function(){return a._instance||(a._instance=new a)},a.prototype.bindEvent=function(){var e=this;e.send.addEventListener(egret.TouchEvent.TOUCH_TAP,e.handleSend,e),BaseWar.getInstance().bind("keyCode:13",e.handleSend,e)},a.prototype.handleSend=function(){var t=this;return"1"==e.PersonalModel.getInstance().black?void console.log("你被关进小黑屋, 联系管理员"):void(t.input.text&&(t.ws.send(t.input.text),t.input.text="",t.vb.scroller.scrollPosY=t.vb.scroller.scrollBarV.maximum))},a.prototype.createWebsocket=function(t){var n=this;n.ws=MainSocket.getInstance().connect(UserData.getInstance().host+":8080/chat/"+t.data.userId+"/"+e.PersonalModel.getInstance().grade+"/"+t.data.nickName),n.ws.onmessage(n.onmessage,n)},a.prototype.onmessage=function(e){var t=this;if(e&&"string"==typeof e.data){var n=JSON.parse(e.data);t.vb.dataProvider?(t.vb.dataProvider.push(n),t.vb.validData()):t.vb.dataProvider=[n]}},a.prototype.test=function(){var e=this;e.onmessage(e.arr[Math.floor(Math.random()*e.arr.length)])},a}(GYLite.GYUIComponent);e.ChatView=t,__reflect(t.prototype,"main.ChatView");var n=function(e){function t(){var t=e.call(this)||this,n=t;return n.color={1:16777215,2:4171177,3:4171177,4:10400859,5:10400859,6:12213083},n.width=210,n.mes=SkinManager.createText(n,2,0,"",16777215,14),n.mes.width=n.width-4,t}return __extends(t,e),t.prototype.setData=function(e){var t=this;t.mes.text=e.nickName+" : "+e.msg,t.updateState(e)},t.prototype.updateState=function(e){var t=this;t.height=t.mes.contentHeight+22,t.mes.color=t.color[e.grade]||t.color[6]},t}(GYLite.ItemRender);__reflect(n.prototype,"ChatItem")}(main||(main={}));var main;!function(e){var t=function(){function t(){var e=this;e._timeId=-1}return t.getInstance=function(){return t._instance||(t._instance=new t)},t.prototype.run=function(){var t=this;e.GameModel.getInstance().getTime(function(e){var n=new Date(e.data).getSeconds();console.log("服务器时间第: ",n+"秒"),t.gameTtime=n,t.gameStart()},t)},t.prototype.gameStart=function(){var e=this,t=e.gameTtime;e.gameTtime<=25&&(t=25-e.gameTtime,e.betTime=t,console.log("下注时间还剩: ",t)),e._timeId=GYLite.TimeManager.timeInterval(e.timeStart,e,1e3)},t.prototype.timeStart=function(){var e=this,t=++e.gameTtime;t>0&&26>t?(e.betTime=25-t,console.log("下注时间还剩: ",e.betTime)):t>=27&&32>=t?console.log("锁定时间: ",t):t>32&&58>=t?console.log("开奖时间: ",t):t>58&&(console.log("该轮游戏到达59阶段, 可开始请求时间戳, 进入下一轮游戏"),GYLite.TimeManager.unTimeInterval(e._timeId,e.timeStart,e),e.run())},t}();e.GameTime=t,__reflect(t.prototype,"main.GameTime")}(main||(main={}));var main;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.prototype.modulePreStart=function(){e.TheFirstGame.getInstance().isFirstGame=!0},n.prototype.start=function(){t.prototype.start.call(this)},n.prototype.runGame=function(){},n.prototype.resize=function(e,t){},n.prototype.dispose=function(){t.prototype.dispose.call(this)},n.prototype.show=function(n){void 0===n&&(n=null);var a=this;t.prototype.show.call(this,n),a.back=SkinManager.createImage(a,0,0,URLConf.mainImg+"war_bg_2.jpg"),a.back.horizonalCenter=a.back.verticalCenter=0,a.mainimg=SkinManager.createImage(a,0,0,"war_tar_bg_png",URLConf.gameImg+"w1sheet.png"),a.mainimg.horizonalCenter=0,a.mainimg.verticalCenter=-30,a.sideTopLeft=e.SideTopLeftView.getInstance(),a.sideTopLeft.left=280,a.sideTopLeft.verticalCenter=0,a.addElement(a.sideTopLeft),a.sideTopRight=e.SideTopRightView.getInstance(),a.sideTopRight.right=280,a.sideTopRight.verticalCenter=0,a.addElement(a.sideTopRight),UserData.getInstance().token&&(e.PersonalModel.getInstance().getMyInfo(function(e){a.sideTopLeft.renderPersonvalView(e),a.sideTopLeft.notifyChatView(e)}),a.sideTopRight.bindLoginOut(a.loginout,a),e.GameTime.getInstance().run()),document.addEventListener("keydown",a.handleKeyborad.bind(a))},n.prototype.handleKeyborad=function(e){13==e.keyCode&&BaseWar.getInstance().trigger("keyCode:13")},n.prototype.hide=function(){t.prototype.hide.call(this),e.TheFirstGame.getInstance().isFirstGame=!1},n.prototype.handleMessage=function(e){},n.prototype.loginout=function(){e.PersonalModel.getInstance().logout(function(){UIControl.getInstance().closeCurUI(),UIControl.getInstance().openUI("login")})},n}(ModuleBase);e.Module=t,__reflect(t.prototype,"main.Module")}(main||(main={}));var main;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;n.head=SkinManager.createImage(n,20,20,"q","main/img/head.png"),n.head.scaleX=.5,n.head.scaleY=.5;var a=new GYLite.GYSprite;a.x=n.head.x,a.y=n.head.y,a.width=a.height=50;var i=a.graphics;i.beginFill(0,1),i.drawRoundRect(0,0,50,50,50),i.endFill(),n.head.mask=a,n.addElement(a);var o=SkinManager.createImage(n,80,50,"war_id_img_png",URLConf.gameImg+"w1sheet.png"),r=SkinManager.createScaleImage(n,o.x+o.width,o.y,"war_bet_setting_selected_count__bormal_bg_png",URLConf.gameImg+"w1sheet.png",new GYLite.Scale9GridRect(2,2,2,2));r.width=100,r.height=20;var s=SkinManager.createScaleImage(n,20,90,"war_bet_setting_selected_count__bormal_bg_png",URLConf.gameImg+"w1sheet.png",new GYLite.Scale9GridRect(2,2,2,2));s.width=100,s.height=30;var c=SkinManager.createImage(n,20,90,"war_gold_img_png",URLConf.gameImg+"w1sheet.png"),g=SkinManager.createScaleImage(n,140,90,"war_bet_setting_selected_count__bormal_bg_png",URLConf.gameImg+"w1sheet.png",new GYLite.Scale9GridRect(2,2,2,2));g.width=100,g.height=30;var m=SkinManager.createImage(n,140,90,"war_silver_img_png",URLConf.gameImg+"w1sheet.png");return n.userNickText=SkinManager.createText(n,o.x,20,"",16777215,22),n.userIdText=SkinManager.createText(n,r.x+2,r.y+3,"",16777215,14),n.userGText=SkinManager.createText(n,c.x+c.width+2,c.y+8,"",15715586,14),n.userYText=SkinManager.createText(n,m.x+m.width+2,m.y+8,"",16777215,14),t}return __extends(t,e),t.getInstance=function(){return t._instance||(t._instance=new t)},t.prototype.render=function(e){var t=this;t.userNickText.text=e.data.nickName,t.userIdText.text=e.data.userId,t.userGText.text=e.data.gold,t.userYText.text=e.data.silver},t}(GYLite.GYUIComponent);e.PersonalView=t,__reflect(t.prototype,"main.PersonalView")}(main||(main={}));var main;!function(e){var t=function(){function e(){}return e.sound="main/sound/",e.atlas="main/img/ui.png",e.skeleton="main/skeleton/",e.img="main/img/",e.d1sheetAlias="main/img/d1sheet.png",e.d2sheetAlias="main/img/d2sheet.png",e.d3sheetAlias="main/img/d3sheet.png",e}();e.Conf=t,__reflect(t.prototype,"main.Conf")}(main||(main={}));var main;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t;n.back=SkinManager.createImage(n,0,0,"war_right_bg_png",URLConf.gameImg+"w1sheet.png"),n._imgArr=[];var a=["war_top_list_btn_png","war_account_btn_png","war_setting_btn_png","war_close_btn_png"];n._state={};for(var i=0;i<a.length;i++){var o=SkinManager.createImage(n,70+54*i,20,a[i],"game/img/w1sheet.png");o.imgname=a[i],o.touchEnabled=!0,o.buttonModeForMouse=!0,n._imgArr.push(o)}return n.addEventListener(egret.TouchEvent.TOUCH_TAP,n.handleClick,n),n._state[a[0]]=function(){console.log("0")},n._state[a[1]]=function(){console.log("1")},n._state[a[2]]=function(){console.log("2")},n._state[a[3]]=function(){console.log("登出"),n.loginoutcb&&n.loginoutcb.call(n.loginoutthisobj)},t}return __extends(t,e),t.getInstance=function(){return t._instance||(t._instance=new t)},t.prototype.handleClick=function(e){var t=this;e.target.imgname&&t._state[e.target.imgname]&&t._state[e.target.imgname]()},t.prototype.bindLoginOut=function(e,t){var n=this;n.loginoutcb=e,n.loginoutthisobj=t},t}(GYLite.GYUIComponent);e.SideTopRightView=t,__reflect(t.prototype,"main.SideTopRightView")}(main||(main={}));var main;!function(e){var t=function(){function e(){}return e.getInstance=function(){return e._instance||(e._instance=new e)},e}();e.TheFirstGame=t,__reflect(t.prototype,"main.TheFirstGame")}(main||(main={}));var main;!function(e){var t=function(){function e(){}return e.getInstance=function(){return e._instance||(e._instance=new e)},e.prototype.getTime=function(e,t){BaseHttp.getInstance().sendMsg("/war/game/getTime",{},HTTPConf.M_GET,e,t)},e}();e.GameModel=t,__reflect(t.prototype,"main.GameModel")}(main||(main={}));var main;!function(e){var t=function(){function e(){}return e.getInstance=function(){return e._instance||(e._instance=new e)},e.prototype.getRobotNum=function(){HttpMsg.getInstance().sendMsg("/war/game/robotnum",{},HTTPConf.M_GET,function(e){})},e.prototype.getVipRank=function(){HttpMsg.getInstance().sendMsg("/war/game/getVipRank",{},HTTPConf.M_GET,function(e){})},e.prototype.giveGift=function(e,t,n,a){HttpMsg.getInstance().sendMsg("/war/game/giveGift",{userId:e,type:t,num:n,name:a},HTTPConf.M_POST,function(e){})},e.prototype.addNotice=function(e){HttpMsg.getInstance().sendMsg("/war/game/addNotice",{msg:e},HTTPConf.M_POST,function(e){})},e.prototype.selectWinRank=function(e,t){HttpMsg.getInstance().sendMsg("/war/accountrecord/selectWinRank",{type:e,tody:t},HTTPConf.M_GET,function(e){})},e.prototype.getMyRecord=function(){HttpMsg.getInstance().sendMsg("/war/accountrecord/getMyRecord",{},HTTPConf.M_GET,function(e){})},e}();e.MainModel=t,__reflect(t.prototype,"main.MainModel")}(main||(main={}));var main;!function(e){var t=function(){function e(){}return e.getInstance=function(){return e._instance||(e._instance=new e)},e.prototype.setData=function(e){var t=this;for(var n in e)t[n]=e[n];t.grade=t.getGrade(t.exp)},e.prototype.getGrade=function(e){return 500>=e?"1":e>500&&1e3>=e?"2":e>1e3&&3e3>=e?"3":e>3e3&&5e3>=e?"4":e>5e3&&1e4>=e?"5":"6"},e.prototype.updatePrivacy=function(e){HttpMsg.getInstance().sendMsg("/war/user/updatePrivacy",{privacy:e},HTTPConf.M_POST,function(e){})},e.prototype.getMyInfo=function(e){var t=this;BaseHttp.getInstance().sendMsg("/war/user/getMyInfo",{},HTTPConf.M_GET,function(n){t.setData(n.data),e&&e(n)})},e.prototype.getInfoById=function(e){HttpMsg.getInstance().sendMsg("/war/user/getInfoById",{userId:e},HTTPConf.M_GET,function(e){})},e.prototype.logout=function(e){BaseHttp.getInstance().sendMsg("/logout",{},HTTPConf.M_POST,function(t){UserData.getInstance().token="",sessionStorage.removeItem("token"),e&&e(t)})},e}();e.PersonalModel=t,__reflect(t.prototype,"main.PersonalModel")}(main||(main={}));